<!DOCTYPE html>
<html>
	<head>
		<title>JsUnit testing page</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

		<!-- JsUnitClient driver -->
		<script type="text/javascript" src="../../../jsUnitClient.js"></script>
		<script type="text/javascript">
			JsUnitClient.include("runtime.js");
			JsUnitClient.include("languages/xul/xul.js");
			JsUnitClient.include("languages/xul/themes/default/style.css");
		</script>

		<!-- Tests -->
		<script type="text/javascript">
			// 
			function testObserver() {
				var oObserver	= ample.getElementById("observer");
				var sStyle = oObserver.getAttribute("style");
				var sLabel = oObserver.getAttribute("label");
				assertEquals(sStyle, "color: black");
				assertEquals(sLabel, "Color changed");
			}
		</script>
	</head>
	<body>
		<p>Ample SDK JsUnit suite page - XUL Broadcast Observes</p>
		<script>
		       ample.ready(function() {
			   //Push the button.
		           ample.query("#initiator").doCommand(); 
		       });
		</script>

		<script type="application/ample+xml">
		<xul:page xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
			<xul:broadcasterset>
			  <xul:broadcaster id="colorChanger" style="color: black"/>
			</xul:broadcasterset>

			<xul:button id="observer" label="Test">
			  <xul:observes element="colorChanger" attribute="style" onbroadcast="this.parent.label='Color changed';"/>
			</xul:button>

			<xul:button id="initiator" label="Observer"
			  oncommand="document.getElementById('colorChanger').setAttribute('style','color: red');"
			/>
		</xul:page>
		</script>
	</body>
</html>
